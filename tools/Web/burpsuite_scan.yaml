name: Burp Suite (Dastardly)
description: Web application vulnerability scanner for CI/CD by PortSwigger.
arguments:
  - name: target
    description: Target URL
    required: true
    type: string

docker:
  docker_mode: custom
  base_image: public.ecr.aws/portswigger/dastardly:latest
  # We use the official image as base. 
  # It already has java and the jar.
  # We just need to add python for our wrapper.
  user: root
  apt_packages:
    - python3
    - python3-pip
  run_commands:
    - ln -s /usr/bin/python3 /usr/local/bin/python

resources:
  limits:
    cpu: 2000m
    memory: 4096Mi
  requests:
    cpu: 500m
    memory: 2048Mi

schema:
  type: object
  required:
    - target
  properties:
    target:
      type: string
      description: Target URL
